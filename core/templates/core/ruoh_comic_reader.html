{% extends "core/base.html" %}
{% load static %}

{% block title %}{{ comic_title }} â€” {{ chapter_title }}{% endblock %}

{% block content %}
<header class="comic-head">
  <div class="comic-head-inner">
    <div class="comic-kicker">CASE FILE</div>
    <h1 class="comic-title">{{ comic_title }} // {{ chapter_title }}</h1>
    <div class="comic-actions">
      <a class="btn-secondary" href="{% url 'ruoh_comic_book' comic_slug %}">BACK TO CHAPTERS</a>
    </div>
  </div>
</header>

<main class="comic-reader comic-reader--{{ mode }}">

  {% if mode == "webtoon" %}
    <!-- WEBTOON MODE: vertical strip, wider container -->
    <div class="webtoon-strip">
      {% for p in pages %}
        <img class="webtoon-slice" src="{% static p %}" alt="Slice {{ forloop.counter }}" loading="lazy">
      {% endfor %}
    </div>

  {% else %}
    <!-- DESKTOP MODE: framed stage (your current style) -->
    <div class="comic-stage">
      {% for p in pages %}
        <img class="comic-page is-visible" src="{% static p %}" alt="Page {{ forloop.counter }}" loading="lazy">
      {% endfor %}
    </div>
  {% endif %}

</main>

    <script>
(function () {
  const params = new URLSearchParams(window.location.search);
  if (params.get("mode")) return; // user forced it

  if (window.matchMedia("(max-width: 820px)").matches) {
    params.set("mode", "webtoon");
    const url = window.location.pathname + "?" + params.toString();
    window.location.replace(url);
  }
})();
</script>

{% endblock %}
